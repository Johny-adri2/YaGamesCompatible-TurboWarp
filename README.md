![logo](https://raw.githubusercontent.com/timaaos/YandexGamesTurboWarp/main/logo.png)
# YandexGamesTurboWarp
Расширение Yandex Games SDK для Турбоварпа. Не работает в режиме песочницы.
#### Плюсы:
 + Маленький билд
 + Это Турбоварп (быстрый, компилируемый мод скретча)
 + Любой чайник разберётся
 + Мега оптимизация
#### Минусы:
 - Это скретч
 - Не ООП
 - Без ECS
 - Что вы ещё хотели от скретча?!
## Как начать использовать?
### Вариант 1
1. Копируем вот этот код: 
```
!function(e){"use strict";e.extensions.register(new class{getInfo(){return console.log("YaGamesTurbowarp extension by @timaaos\nhttps://github.com/timaaos/YandexGamesTurboWarp"),{id:"yagames",name:"Yandex Games SDK",color1:"#4C1CBA",blocks:[{opcode:"initsdk",blockType:e.BlockType.COMMAND,text:"Initialize YaGames SDK"},{opcode:"setdebug",blockType:e.BlockType.COMMAND,text:"Enable debug mode"},{opcode:"getsavedvar",blockType:e.BlockType.REPORTER,text:"Get saved variable [NAME] default value [DEFVAL]",arguments:{NAME:{defaultValue:"money",type:e.ArgumentType.STRING},DEFVAL:{defaultValue:"100",type:e.ArgumentType.STRING}}},{opcode:"setsavedvar",blockType:e.BlockType.COMMAND,text:"Set saved variable [NAME] value [VALUE]",arguments:{NAME:{defaultValue:"money",type:e.ArgumentType.STRING},VALUE:{defaultValue:"100",type:e.ArgumentType.STRING}}},{opcode:"sdkenabled",blockType:e.BlockType.BOOLEAN,text:"Is SDK Enabled"},{opcode:"dataloaded",blockType:e.BlockType.BOOLEAN,text:"Is data loaded?"},{opcode:"savevars",blockType:e.BlockType.COMMAND,text:"Save progress"},{opcode:"loadvars",blockType:e.BlockType.COMMAND,text:"Load progress"},{opcode:"resetprogress",blockType:e.BlockType.COMMAND,text:"Reset progress"},{opcode:"showfullscreen",blockType:e.BlockType.COMMAND,text:"Show fullscreen ad"},{opcode:"whenFullscreenClosed",blockType:e.BlockType.HAT,func:"isFullscreenClosed",text:"When fullscreen ad closed"},{opcode:"fullscreenClosed",blockType:e.BlockType.BOOLEAN,text:"Is fullscreen ad closed?"},{opcode:"showrewarded",blockType:e.BlockType.COMMAND,text:"Show rewarded ad"},{opcode:"whenRewardedWatched",blockType:e.BlockType.HAT,func:"isRewardedWatched",text:"When rewarded ad shown"},{opcode:"rewardedRewarded",blockType:e.BlockType.BOOLEAN,text:"Did Rewarded Ad give reward?"},{opcode:"canRateGame",blockType:e.BlockType.BOOLEAN,text:"Can rate game?"},{opcode:"openRatePopup",blockType:e.BlockType.COMMAND,text:"Open Rating Popup"},{opcode:"getDeviceType",blockType:e.BlockType.REPORTER,text:"Device Type"},{opcode:"isDesktop",blockType:e.BlockType.BOOLEAN,text:"Is playing on Desktop?"},{opcode:"isMobile",blockType:e.BlockType.BOOLEAN,text:"Is playing on Mobile?"},{opcode:"isTablet",blockType:e.BlockType.BOOLEAN,text:"Is playing on Tablet?"},{opcode:"isTV",blockType:e.BlockType.BOOLEAN,text:"Is playing on TV?"}]}}getDeviceType(){return 1==window.ysdkdebug?"desktop":ysdk.deviceInfo.type}isDesktop(){return 1==window.ysdkdebug||ysdk.deviceInfo.isDesktop()}isMobile(){return 1!=window.ysdkdebug&&ysdk.deviceInfo.isMobile()}isTablet(){return 1!=window.ysdkdebug&&ysdk.deviceInfo.isTablet()}isTV(){return 1!=window.ysdkdebug&&ysdk.deviceInfo.isTV()}canRateGame(){return 1==window.ysdkdebug?!(1==window.alreadyrated):(ysdk.feedback.canReview().then((({value:d,reason:o})=>{e=d})),e);var e}openRatePopup(){if(1==window.ysdkdebug)return window.alreadyrated=!0,void alert("DEBUG Rate our game");ysdk.feedback.requestReview()}whenRewardedWatched(){console.log("wathced!")}rewardedRewarded(){return 1==window.isrewarded}triggerIRW(){window.triggerIRW=!0}triggerIFC(){this.undeafAE(),window.triggerIFC=!0}isRewardedWatched(){return!!window.triggerIRW&&(window.triggerIRW=!1,!0)}isFullscreenClosed(){return!!window.triggerIFC&&(window.triggerIFC=!1,!0)}fullscreenClosed(){return 1==window.isfullscreenclosed}initsdk(){if(window.onfocus=function(){0==window.isAdOpened&&(e.vm.runtime.audioEngine.inputNode.gain.value=1)},window.onblur=function(){0==window.isAdOpened&&(e.vm.runtime.audioEngine.inputNode.gain.value=0)},window.isAdOpened=!1,document.addEventListener("visibilitychange",(function(){0==window.isAdOpened&&(document.hidden?e.vm.runtime.audioEngine.inputNode.gain.value=0:e.vm.runtime.audioEngine.inputNode.gain.value=1)}),!1),window.savedData="",1==window.ysdkdebug)return window.ysdk={},void(window.ysdkplayer={});var d=document.createElement("script");d.src="https://yandex.ru/games/sdk/v2",document.head.appendChild(d),d.onload=async function(){console.log(YaGames),await YaGames.init().then((e=>{window.ysdk=e,e.features.LoadingAPI.ready(),e.getPlayer({scopes:!1}).then((e=>{var d=e;window.ysdkplayer=d,console.log(window.ysdkplayer)})).catch((e=>{}))})),console.log("Initialized YaGames!")}}async loadvars(){if(1!=window.ysdkdebug){if(null!=window.ysdkplayer){var e=await window.ysdkplayer.getData();window.ysdkdata=e,console.log("Succesfully loaded data!")}}else window.ysdkdata={}}setdebug(){window.alreadyrated=!1,window.ysdkdebug=!0}setsavedvar(e){window.ysdkdata[e.NAME]=e.VALUE}getsavedvar(e){return window.ysdkdata[e.NAME]||e.DEFVAL}savevars(){null!=window.ysdkplayer&&null!=window.ysdkdata&&window.savedData!==JSON.stringify(window.ysdkdata)&&window.ysdkplayer.setData(window.ysdkdata,!0).then((()=>{window.savedData=JSON.stringify(window.ysdkdata),console.log("Successfully saved data!")}))}resetprogress(){window.ysdkdata={},null!=window.ysdkplayer&&null!=window.ysdkdata&&window.savedData!==JSON.stringify(window.ysdkdata)&&window.ysdkplayer.setData(window.ysdkdata,!0).then((()=>{window.savedData=JSON.stringify(window.ysdkdata),console.log("Successfully saved data!")}))}sdkenabled(){return null!=window.ysdk}dataloaded(){return null!=window.ysdkplayer&&null!=window.ysdkdata}deafAE(){e.vm.runtime.audioEngine.inputNode.gain.value=0}undeafAE(){e.vm.runtime.audioEngine.inputNode.gain.value=1}showfullscreen(){if(window.isfullscreenclosed=!1,window.isAdOpened=!0,e.vm.runtime.audioEngine.inputNode.gain.value=0,1==window.ysdkdebug)return alert("Fullscreen ad!"),window.isfullscreenclosed=!0,e.vm.runtime.audioEngine.inputNode.gain.value=1,window.triggerIFC=!0,void(window.isAdOpened=!1);null!=window.ysdk&&window.ysdk.adv.showFullscreenAdv({callbacks:{onClose:function(d){window.isfullscreenclosed=!0,window.triggerIFC=!0,window.isAdOpened=!1,e.vm.runtime.audioEngine.inputNode.gain.value=1},onError:function(e){window.isfullscreenclosed=!1,window.triggerIFC=!0,window.isAdOpened=!1}}})}showrewarded(){if(window.isrewardedwatched=!1,window.isrewarded=!1,window.isAdOpened=!0,this.deafAE(),1==window.ysdkdebug){var e=prompt("DEBUG Rewarded Ad! Write C to close it, write R to get trigger reward.");return"c"==e.toLowerCase()?(window.isrewardedwatched=!0,window.isrewarded=!1):"r"==e.toLowerCase()&&(window.isrewardedwatched=!0,window.isrewarded=!0),window.isAdOpened=!1,void this.triggerIRW()}window.ysdk.adv.showRewardedVideo({callbacks:{onOpen:()=>{window.isrewardedwatched=!1,window.isrewarded=!1},onRewarded:()=>{window.isrewarded=!0,window.isAdOpened=!1,this.triggerIRW()},onClose:()=>{window.isrewardedwatched=!0,window.isAdOpened=!1,this.undeafAE(),this.triggerIRW()},onError:e=>{window.isrewardedwatched=!1,window.isrewarded=!1,window.isAdOpened=!1}}})}})}(Scratch);
```
2. Заходим в Turbowarp
3. Жмём вот эту кнопку:  
![image](https://github.com/timaaos/YandexGamesTurboWarp/assets/75538611/73586604-c469-4bae-bc75-34788c5ad3da)
4. Ищем такое расширение:  
![image](https://github.com/timaaos/YandexGamesTurboWarp/assets/75538611/de2dad56-aae3-4901-a203-0a64f7765a8d)
5. Жмём, выбираем Text, ставим галочку загрузки "вне песочницы" и вставляем скопированный код в поле.  
![image](https://github.com/timaaos/YandexGamesTurboWarp/assets/75538611/39611c17-d91e-479b-ba75-b535367760c9)
6. Жмём Load и начинаем пользоваться!
### Вариант 2
[См. документацию](https://github.com/timaaos/YandexGamesTurboWarp/wiki/%D0%9A%D0%B0%D0%BA-%D0%BD%D0%B0%D1%87%D0%B0%D1%82%D1%8C-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D1%8C)
## Документация
[Документация на Github Wiki](https://github.com/timaaos/YandexGamesTurboWarp/wiki)
